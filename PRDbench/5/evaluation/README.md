# 产品需求模板与自动生成工具使用说明

## 简介

本工具是一个命令行应用程序，旨在通过结构化模板和自动化处理流程，帮助产品团队快速生成标准化的产品需求文档(PRD)。工具集成了图片处理、特征提取和文档生成等功能，能够显著提高产品文档编写的效率和质量。

## 环境配置

### 系统要求

- Python 3.7 或更高版本
- Windows、macOS 或 Linux 操作系统

### 安装依赖

1. 克隆或下载项目到本地目录
2. 打开终端或命令提示符，进入项目根目录
3. 运行以下命令安装依赖包：

```bash
pip install -r src/requirements.txt
```

### 依赖包说明

- `opencv-python`: 用于图像处理和计算机视觉功能（可选，有简化实现作为备选）
- `Pillow`: 用于图像处理
- `scikit-learn`: 用于机器学习算法（可选，有简化实现作为备选）
- `requests`: 用于网络请求（调用大语言模型API）

### 处理依赖安装问题

在某些系统上（特别是Windows），安装某些依赖包可能会遇到问题：

1. **使用国内镜像源**：
   ```bash
   pip install -r src/requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple
   ```

2. **只安装预编译的二进制包**：
   ```bash
   pip install -r src/requirements.txt --only-binary=all
   ```

3. **如果仍然无法安装opencv-python或scikit-learn**：
   - 程序内置了简化版本的实现，不依赖这些库也能运行基础功能
   - 程序会自动检测依赖是否存在，如果不存在则使用简化实现

## 使用方法

### 启动工具

在项目根目录下运行以下命令启动工具：

```bash
python src/main.py
```

### 主要功能

工具启动后会显示主菜单，包含以下选项：

1. **创建/编辑需求模板**
   - 按照提示输入产品基本信息（产品名称、目标用户）
   - 设置图片资源规范（来源类型、允许的文件格式）
   - 定义产品特征要求（风格关键词、色彩情感倾向）
   - 输入模板名称并保存

2. **基于模板生成产品PRD**
   - 从已保存的模板中选择一个
   - 提供符合模板规范的图片资源路径
   - （可选）输入大语言模型API密钥以生成风格描述
   - 工具将自动处理图片、提取特征并生成PRD文档

3. **退出工具**
   - 安全退出程序

### 详细操作流程

#### 创建产品需求模板

1. 选择菜单项 1 进入模板创建流程
2. 按提示输入产品名称和目标用户
3. 确认图片资源规范（默认为本地路径，支持JPG/PNG/WebP格式）
4. 输入风格关键词（多个关键词用逗号分隔）
5. 从预定义选项中选择色彩情感倾向
6. 输入模板名称并保存

#### 生成产品PRD文档

1. 选择菜单项 2 进入PRD生成流程
2. 从列表中选择一个已保存的模板
3. 逐行输入图片文件的绝对路径（每行一个，输入空行结束）
4. （可选）输入大语言模型API密钥以生成风格描述（输入'skip'可跳过）
5. （可选）输入生成文档的名称
6. 工具将自动处理图片、提取特征并生成PRD文档

### 输出文件

- 生成的PRD文档将保存在 `src/output/` 目录下，格式为Markdown
- 处理后的图片将保存在 `src/images/` 目录下
- 模板文件保存在 `src/templates/` 目录下

## 技术说明

### 图片处理流程

1. **格式验证**: 验证图片格式是否符合模板要求
2. **预处理**: 统一转换为模板指定的优先格式，清理元数据
3. **特征提取**: 
   - 使用颜色直方图方法提取主色调（前3个）
   - 通过像素差异分析纹理特征（细腻/粗糙）
4. **风格描述生成**: （可选）调用大语言模型API生成符合AIDA模型的描述

### 文档结构

生成的PRD文档包含以下部分：

1. 产品概述
2. 图片资源规范
3. 核心特征描述
4. 开发排期建议（基于关键路径法）

## 注意事项

1. 图片路径需要是绝对路径
2. API密钥格式需符合OpenAI密钥规范（以sk-开头的48位字符串）
3. 工具会自动创建必要的目录（templates、images、output）
4. 处理大量图片时可能需要较长时间，请耐心等待

## 故障排除

### 常见问题

1. **无法安装依赖包**
   - 确保已正确安装Python和pip
   - 尝试使用国内镜像源安装：`pip install -r src/requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple`
   - 如果特定包无法安装，程序会自动使用简化实现

2. **图片处理失败**
   - 检查图片路径是否正确
   - 确认图片格式是否在模板允许的范围内
   - 确保图片文件未被其他程序占用

3. **API调用失败**
   - 检查API密钥格式是否正确
   - 确认网络连接正常
   - 检查API服务是否正常运行

### 获取帮助

如遇到其他问题，请查看源代码中的注释或联系开发者。

## 版本信息

当前版本：1.0.0