[
  {
    "metric": "1.1 Program Startup and Main Menu Display",
    "description": "1. **Act:** Execute `python main.py` in the command line to start the program.\n2. **Assert:** Observe whether the program starts successfully and displays a clear menu containing at least 5 main functional options (such as Certificate Management, User Management, CRL Management, System Configuration, Exit Program).",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_1.1.in"
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Program starts successfully, displaying clear main menu"
  },
  {
    "metric": "2.1.1a CA Key Pair Generation - 5120-bit RSA Key Generation",
    "description": "1. **Precheck (User Path):** Confirm access to CA key pair generation functionality.\n2. **Act:** Execute CA key pair generation operation.\n3. **Assert:** Verify the generated RSA key length is 5120 bits, check whether the generated public and private key files exist and have correct formats.",
    "type": "file_comparison",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.1.1a.in"
      }
    ],
    "input_files": null,
    "expected_output_files": [
      "evaluation/expected_outputs/expected_ca_private_key.pem",
      "evaluation/expected_outputs/expected_ca_certificate.pem"
    ],
    "expected_output": "Successfully generated key pair and files similar to target files"
  },
  {
    "metric": "2.1.1b CA Key Pair Generation - PEM Format Storage",
    "description": "1. **Arrange:** Ensure CA key pair has been generated.\n2. **Act:** Inspect the generated CA public and private key files.\n3. **Assert:** Verify whether key files are stored in standard PEM format, containing correct header and footer identifiers (e.g., -----BEGIN RSA PRIVATE KEY-----).",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_ca_pem_format.py::test_ca_pem_format",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "CA key files fully comply with PEM format standards, containing correct header and footer identifiers"
  },
  {
    "metric": "2.1.2a User Certificate Application - Menu Access Path",
    "description": "1. **Precheck (User Path):** In the main menu, is there a clear \"User Certificate Application\" or \"Apply Digital Certificate\" option?\n2. **Act:** Select the corresponding menu option to enter user certificate application functionality.\n3. **Assert:** Observe whether able to successfully enter the user certificate application interactive interface.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.1.2a.in"
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Successfully entered user certificate application interface"
  },
  {
    "metric": "2.1.2b User Certificate Application - Digital Certificate Generation",
    "description": "1. **Arrange:** Ensure user information has been correctly entered and CA key pair exists.\n2. **Act:** Complete user certificate application process.\n3. **Assert:** Verify whether successfully generated digital certificate file containing user identity information, with correct certificate format and validity period information.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.1.2b.in"
      },
      {
        "test_command": "openssl x509 -in src/data/certs/测试用户3.pem -text -noout",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Successfully generated user digital certificate"
  },
  {
    "metric": "2.2.1a Identity Authentication Verification - Menu Access Path",
    "description": "1. **Precheck (User Path):** In the main menu, is there a clear \"Identity Authentication\" or \"Certificate Verification\" option?\n2. **Act:** Select the corresponding menu option to enter identity authentication functionality.\n3. **Assert:** Observe whether able to successfully enter the identity authentication interactive interface.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.2.1a.in"
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Successfully entered user certificate authentication interactive interface"
  },
  {
    "metric": "2.2.1b Identity Authentication Verification - Certificate Existence Verification",
    "description": "1. **Precheck (User Path):** Confirm access to identity authentication functionality.\n2. **Arrange:** Prepare one valid user certificate file and one non-existent certificate filename.\n3. **Act:** Verify existing and non-existing certificates respectively.\n4. **Assert:** Verify system can correctly identify whether certificate files exist and provide corresponding prompts.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.2.1b.in"
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "System accurately detects certificate file existence, provides correct feedback for both existing and non-existing cases"
  },
  {
    "metric": "2.2.1c Identity Authentication Verification - Certificate Validity Period Verification",
    "description": "1. **Arrange:** Prepare one certificate within validity period and one expired certificate (if possible).\n2. **Act:** Verify certificates with different validity statuses.\n3. **Assert:** Verify system can correctly check certificate validity period and provide corresponding warnings for expired certificates.",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_cert_validity.py::test_certificate_validity",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "System accurately checks certificate validity period, provides correct judgments for both valid and expired certificates"
  },
  {
    "metric": "2.3.1a Certificate Revocation Management - Menu Access Path",
    "description": "1. **Precheck (User Path):** In the main menu, is there a clear \"Certificate Revocation\" or \"Revoke Certificate\" option?\n2. **Act:** Select the corresponding menu option to enter certificate revocation functionality.\n3. **Assert:** Observe whether able to successfully enter the certificate revocation interactive interface.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.3.1a.in"
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Successfully entered certificate revocation interactive interface"
  },
  {
    "metric": "2.3.1b Certificate Revocation Management - Revocation Application Processing",
    "description": "1. **Precheck (User Path):** Confirm access to certificate revocation functionality.\n2. **Arrange:** Prepare one valid user certificate and revocation reason.\n3. **Act:** Submit certificate revocation application, input revocation reason.\n4. **Assert:** Verify system can correctly receive revocation application and record revocation reason and timestamp.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.3.1b.in"
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Successfully revoked certificate"
  },
  {
    "metric": "2.4.1a File Encryption Functionality - Menu Access Path",
    "description": "1. **Precheck (User Path):** In the main menu, is there a clear \"File Encryption\" option?\n2. **Act:** Select the corresponding menu option to enter file encryption functionality.\n3. **Assert:** Observe whether able to successfully enter the file encryption interactive interface.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.4.1a.in"
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Successfully entered file encryption interactive interface"
  },
  {
    "metric": "2.4.1b File Encryption Functionality - File Path Validation",
    "description": "1. **Precheck (User Path):** Confirm access to file encryption functionality.\n2. **Arrange:** Prepare one existing file path and one non-existent file path.\n3. **Act:** Input existing and non-existent file paths respectively.\n4. **Assert:** Verify system can correctly validate file path effectiveness, provide error prompts for invalid paths.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.4.1b.in"
      }
    ],
    "input_files": [
      "evaluation/inputs/test_file.txt"
    ],
    "expected_output_files": null,
    "expected_output": "System accurately validates file path effectiveness, provides correct feedback for both effective and ineffective paths"
  },
  {
    "metric": "2.4.1c File Encryption Functionality - RSA Encryption and Storage",
    "description": "1. **Arrange:** Prepare one small file (such as text file) and valid user public key.\n2. **Act:** Use user public key to perform RSA encryption on file.\n3. **Assert:** Verify encryption process can complete normally, generate encrypted file. Also verify encrypted file is correctly stored, file integrity ensured.",
    "type": "file_comparison",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.4.1c.in"
      }
    ],
    "input_files": [
      "evaluation/inputs/test_file.txt"
    ],
    "expected_output_files": [
      "evaluation/expected_outputs/expected_encrypted_file.enc"
    ],
    "expected_output": "Successfully encrypted and generated valid encrypted file. Encrypted file correctly stored"
  },
  {
    "metric": "2.5.1a File Decryption Functionality - Menu Access Path",
    "description": "1. **Precheck (User Path):** In the main menu, is there a clear \"File Decryption\" option?\n2. **Act:** Select the corresponding menu option to enter file decryption functionality.\n3. **Assert:** Observe whether able to successfully enter the file decryption interactive interface.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.5.1a.in"
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Successfully entered file decryption interactive interface"
  },
  {
    "metric": "2.5.1b File Decryption Functionality - RSA Decryption Processing",
    "description": "1. **Arrange:** Prepare one encrypted file and corresponding user private key.\n2. **Act:** Use user private key to perform RSA decryption on encrypted file.\n3. **Assert:** Verify decryption process can complete normally, restore original file content.",
    "type": "shell_interaction",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.5.1b.in"
      }
    ],
    "input_files": [
      "evaluation/inputs/test_encrypted_file.enc"
    ],
    "expected_output_files": null,
    "expected_output": "Successfully decrypted file, completely restored original file content"
  },
  {
    "metric": "2.5.1c File Decryption Functionality - Private Key Acquisition and Verification",
    "description": "1. **Arrange:** Prepare user private key file path.\n2. **Act:** System reads and verifies user private key file.\n3. **Assert:** Verify system can correctly read private key file, verify private key format and integrity.",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_private_key_validation.py::test_private_key_validation",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "System correctly reads and verifies private key file, ensuring private key format correct and complete"
  },
  {
    "metric": "2.6.1a Security Protection - Replay Attack Protection",
    "description": "1. **Arrange:** Prepare identical operation request data.\n2. **Act:** Send identical operation requests repeatedly within short time period.\n3. **Assert:** Verify system can detect and reject replay attacks, prevent duplicate operations through timestamp verification mechanism.",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_security_protection.py::test_replay_attack_protection",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "System effectively detects and rejects replay attacks, timestamp verification mechanism comprehensive"
  },
  {
    "metric": "2.6.1b Security Protection - Birthday Attack Protection",
    "description": "1. **Act:** Check system generated key length and randomness.\n2. **Assert:** Verify system uses 5120-bit RSA keys, key space sufficiently large, can effectively defend against birthday attacks.",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_security_protection.py::test_birthday_attack_protection",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Using 4096-bit RSA key, key space sufficient, can effectively defend against birthday attacks"
  },
  {
    "metric": "2.6.1c Security Protection - Dictionary Attack Protection",
    "description": "1. **Act:** Check system requirements for key complexity and verification mechanism.\n2. **Assert:** Verify system can enforce sufficiently complex keys, possess dictionary attack detection capability.",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_security_protection.py::test_dictionary_attack_protection",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "System enforces complex keys, possesses comprehensive dictionary attack detection and protection mechanism"
  },
  {
    "metric": "2.7.1a System Monitoring and Logging - Operation Log Recording",
    "description": "1. **Act:** Execute various system operations (certificate application, verification, revocation, etc.).\n2. **Assert:** Verify system can completely record user operation behaviors, logs contain timestamp, operation type, operation result and other key informations.",
    "type": "file_comparison",
    "testcases": [
      {
        "test_command": "python src/main.py",
        "test_input": "evaluation/inputs/inputs_for_test_2.7.1a.in"
      }
    ],
    "input_files": null,
    "expected_output_files": [
      "evaluation/expected_outputs/expected_system_events.log"
    ],
    "expected_output": "System completely records all key operations, log information detailed and format standardized"
  },
  {
    "metric": "3.1 Technical Implementation - Python Version Compatibility",
    "description": "1. **Act:** Check system Python version requirements and dependency package configuration.\n2. **Assert:** Verify system supports Python 3.6+ version, dependency package configuration correct and complete.",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_python_compatibility.py::test_python_version_compatibility",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "System completely supports Python 3.6+, dependency package configuration complete and version compatible"
  },
  {
    "metric": "3.2 Technical Implementation - Encryption Library Usage",
    "description": "1. **Act:** Check encryption libraries used by system (such as rsa, cryptography, etc.).\n2. **Assert:** Verify system correctly uses standard encryption libraries, implements RSA encryption, hash algorithms and other functionalities.",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_crypto_library.py::test_crypto_library_usage",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "Correctly uses standard encryption libraries, encryption functionality implementation complete and secure"
  },
  {
    "metric": "4.1 Data Storage - File Structure Organization",
    "description": "1. **Act:** Check system file storage structure.\n2. **Assert:** Verify system organizes file structure according to specifications, contains necessary directories such as data, logs, config, etc., file classification storage reasonable.",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_file_structure.py::test_file_structure_organization",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "File structure completely complies with specifications, directory organization reasonable, file classification clear"
  },
  {
    "metric": "4.2 Data Storage - File Format Standards",
    "description": "1. **Act:** Check generated key, certificate and other file formats.\n2. **Assert:** Verify all files comply with corresponding standard formats (PEM format, X.509 standard, etc.).",
    "type": "unit_test",
    "testcases": [
      {
        "test_command": "pytest evaluation/tests/test_file_format.py::test_file_format_standards",
        "test_input": null
      }
    ],
    "input_files": null,
    "expected_output_files": null,
    "expected_output": "All files completely comply with corresponding standard formats, format standardized and good compatibility"
  }
]