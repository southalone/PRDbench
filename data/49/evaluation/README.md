# 评测标准与测试接口说明

## 概述

本目录包含了IoT环境数据采集与智能预测系统的完整评测标准和自动化测试接口，用于客观、精准、可复现地评估系统实现质量。

## 文件说明

### 1. metric.json
人工评测标准文件，包含19个评分点，总分100分。

**评分维度：**
- 系统基础功能 (25分)
- MQTT通信功能 (30分) 
- 数据管理功能 (20分)
- 机器学习功能 (15分)
- 系统监控功能 (5分)
- 用户体验 (5分)

**评分规则：**
- 每个评分点：0分（不可用）、1分（部分可用）、2分（完全可用）
- 权重系数：1-5分，反映功能重要性
- 最终得分 = Σ(评分点得分 × 权重系数)

### 2. detailed_test_plan.json
详细测试计划文件，包含完整的测试用例定义和执行步骤。

**包含内容：**
- 测试环境要求
- 预测试设置步骤
- 19个详细测试用例
- 评分规则和等级映射
- 测试执行说明

### 3. agent_test_interface.py
Agent自动化测试接口，提供程序化的测试执行能力。

**主要功能：**
- 自动执行所有测试用例
- 命令行操作和文件检查
- 数据格式验证
- 交互式CLI测试模拟
- 自动生成测试报告

## 使用方法

### 人工评测

1. 参考 `metric.json` 中的评分标准
2. 按照"验证方法"逐项测试
3. 根据"得分规范"给出评分
4. 计算加权总分

### Agent自动评测

```bash
# 运行自动化测试
cd evaluation
python agent_test_interface.py

# 查看测试报告
cat test_report.json
```

### 单独测试特定功能

```bash
# 测试MQTT功能
cd ../src
python main.py mqtt publish --random

# 测试数据分析
python main.py data analyze

# 测试机器学习
python main.py ml train --data-file samples/environmental_sample.csv --epochs 10
python main.py ml predict --temperature 25.0 --humidity 60.0 --pressure 1013.25

# 测试系统监控
python main.py system status

# 测试Web界面
python main.py web
```

## 评测重点

### 1. 用户体验优先
- CLI界面是否友好易用
- 错误提示是否清晰
- 操作流程是否符合直觉

### 2. 功能完整性
- PRD中的每个功能点都有对应实现
- 核心业务流程完整可用
- 数据处理链路畅通

### 3. 系统稳定性
- 错误处理机制完善
- 异常情况不会导致崩溃
- 日志记录详细完整

### 4. 技术规范符合性
- 数据格式符合PRD要求
- 技术栈使用正确
- 性能指标达标

## 评分标准详解

### 高权重功能 (权重4-5)
- **系统启动与帮助** (权重5): 基础功能，必须完全可用
- **MQTT通信** (权重4): 核心业务功能
- **机器学习训练** (权重5): 系统核心价值
- **数据分析** (权重4): 重要的数据处理功能

### 中权重功能 (权重3)
- **数据清洗合并**: 数据预处理功能
- **模型评估**: ML辅助功能
- **系统监控**: 运维支持功能
- **配置管理**: 系统管理功能

### 低权重功能 (权重1-2)
- **日志记录**: 基础支持功能
- **错误处理**: 系统健壮性

## 测试执行建议

### 1. 环境准备
```bash
# 检查Python版本
python --version

# 安装依赖
pip install -r requirements.txt

# 验证安装
python run.py test
```

### 2. 功能测试顺序
1. 基础功能测试（系统启动、帮助信息）
2. 数据管理测试（分析、清洗、合并）
3. MQTT通信测试（发布、订阅）
4. 机器学习测试（训练、预测、评估）
5. 系统监控测试（状态、实时监控）
6. Web界面测试（服务启动）
7. 配置管理测试（设置向导）

### 3. 评分计算
```
最终得分 = Σ(各评分点得分 × 对应权重) / Σ(所有权重 × 2) × 100
```

### 4. 等级划分
- A级 (90-100分): 优秀，功能完整，用户体验佳
- B级 (80-89分): 良好，主要功能可用
- C级 (70-79分): 中等，基本功能可用但有缺陷
- D级 (60-69分): 及格，部分功能可用
- F级 (0-59分): 不及格，功能缺失严重

## 注意事项

1. **测试环境**: 确保在干净的Python环境中测试
2. **依赖安装**: 所有依赖必须正确安装
3. **文件权限**: 确保有足够的文件读写权限
4. **网络连接**: MQTT功能需要网络连接（可能因为未配置而失败，但不影响基础功能评分）
5. **测试数据**: 使用提供的样本数据进行测试

## 故障排除

### 常见问题
1. **导入错误**: 检查Python路径和模块结构
2. **依赖缺失**: 重新安装requirements.txt中的包
3. **权限问题**: 确保对data、logs、models目录有写权限
4. **MQTT连接失败**: 正常现象，因为未配置真实的阿里云凭据

### 调试建议
1. 查看logs目录下的日志文件
2. 使用 `python run.py test` 进行基础功能验证
3. 逐个测试各功能模块
4. 检查配置文件config.yaml的设置