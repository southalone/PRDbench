[
  {
    "metric": "1.1.1 Excel File Reading: Successfully read the input data file",
    "description": "1. **Arrange:** Ensure that the files src/mdl4.xlsx and src/聚类之后.xlsx exist in the root directory of the AHAU-logistics-GM project.\n2. **Act:** Run the command `python -c \"import pandas as pd; data1=pd.read_excel('src/mdl4.xlsx'); data2=pd.read_excel('src/聚类之后.xlsx'); print(f'mdl4 rows: {len(data1)}, columns: {len(data1.columns)}'); print(f'clustered data rows: {len(data2)}, columns: {len(data2.columns)}')\"`.\n3. **Assert:** Observe whether the number of rows and columns for both files is successfully output.",
    "expected_output": "2 points: Both Excel files are read successfully and the complete row and column information is output. 1 point: The files are read but information output is incomplete or only one file can be read. 0 points: Neither file exists or reading fails."
  },
  {
    "metric": "1.1.2 Data Field Integrity: Verify that the Excel file includes 4 core fields",
    "description": "1. **Arrange:** Ensure the src/聚类之后.xlsx file is readable.\n2. **Act:** Run the command `python -c \"import pandas as pd; data=pd.read_excel('src/聚类之后.xlsx'); print('columns:', len(data.columns)); print('data types:', data.dtypes.tolist())\"`.\n3. **Assert:** Verify that the file contains 4 or more columns of data and the data types are appropriate.",
    "expected_output": "2 points: Excel file contains 4 or more columns of data and the data types are appropriate. 1 point: Contains 3 columns. 0 points: Fewer than 3 columns or abnormal data types."
  },
  {
    "metric": "1.1.3 Coordinate Validity Check: Verify that longitude and latitude coordinates are within valid ranges",
    "description": "1. **Arrange:** Ensure the src/mdl4.xlsx file is readable.\n2. **Act:** Run the command `python -c \"import pandas as pd; data=pd.read_excel('src/mdl4.xlsx'); lon_col=data.iloc[:,1]; lat_col=data.iloc[:,2]; print('longitude range:', lon_col.min(), '-', lon_col.max()); print('latitude range:', lat_col.min(), '-', lat_col.max()); lon_valid=(lon_col >= 73) & (lon_col <= 135); lat_valid=(lat_col >= 3) & (lat_col <= 54); print('valid longitude count:', lon_valid.sum(), '/', len(lon_col)); print('valid latitude count:', lat_valid.sum(), '/', len(lat_col))\"`.\n3. **Assert:** Verify the proportion of longitudes within 73-135 and latitudes within 3-54.",
    "expected_output": "2 points: 100% of longitude coordinates are within 73-135 and 100% of latitude coordinates are within 3-54. 1 point: More than 90% of longitude and latitude coordinates are within the valid range. 0 points: Less than 90% of longitude and latitude coordinates are within the valid range."
  },
  {
    "metric": "1.1.4 Non-Negativity of Weight Data: Verify that weight data is non-negative",
    "description": "1. **Arrange:** Ensure the src/mdl4.xlsx file is readable.\n2. **Act:** Run the command `python -c \"import pandas as pd; data=pd.read_excel('src/mdl4.xlsx'); weight_col=data.iloc[:,3]; print('weight range:', weight_col.min(), '-', weight_col.max()); non_negative_count=(weight_col >= 0); print('non-negative weight count:', non_negative_count.sum(), '/', len(weight_col))\"`.\n3. **Assert:** Verify the proportion of non-negative weights.",
    "expected_output": "2 points: 100% of weight data is non-negative. 1 point: More than 95% of weight data is non-negative. 0 points: Less than 95% of weight data is non-negative."
  },
  {
    "metric": "1.2.1 Single-Center Algorithm: Calculate the global optimal logistics center coordinates",
    "description": "1. **Arrange:** Ensure the src/聚类之后.xlsx file exists.\n2. **Act:** Run the command `python src/单重心法.py`.\n3. **Assert:** Check whether the console outputs both lines: \"Centroid Longitude:\" and \"Centroid Latitude:\"",
    "expected_output": "2 points: Successfully outputs both centroid longitude and latitude in complete format. 1 point: Output exists but format is not standard or one item is missing. 0 points: Program reports an error or no coordinate output."
  },
  {
    "metric": "1.2.2 Single-Center Coordinate Reasonableness and Visualization: Verify the reasonableness of the centroid coordinates and generate a complete scatter plot",
    "description": "1. **Arrange:** Ensure matplotlib can display charts properly and src/聚类之后.xlsx file exists.\n2. **Act:** Run unit tests to validate centroids, and run the script to generate visualization chart.\n3. **Assert:** Verify the centroid longitude is in the range 115-120, latitude in 30-35, and the scatter plot contains blue store points, red centroid point, axis labels, and legend.",
    "expected_output": "2 points: Centroid coordinates are within Anhui province and the chart contains all 4 elements (blue store scatter, red centroid point, axis labels, legend). 1 point: Either coordinate validity or one visualization element is met. 0 points: Coordinates outside reasonable range and fewer than 3 chart elements."
  },
  {
    "metric": "1.3.1 Silhouette Coefficient Analysis and Visualization: Calculate the optimal K value and generate the relationship chart",
    "description": "1. **Arrange:** Ensure src/mdl4.xlsx file exists and matplotlib displays charts properly.\n2. **Act:** Run the command `python src/轮廓系数zh.py`.\n3. **Assert:** Observe whether the console outputs \"maximum silhouette coefficient:\" and \"corresponding K value:\" (K value in the range 2-92), and that the K-value vs. silhouette coefficient plot pops up with proper Chinese labels.",
    "expected_output": "2 points: Successfully outputs maximum silhouette coefficient and K value info (K value between 2-92) and displays complete chart with proper Chinese labels. 1 point: Either console output or chart display meets the requirement. 0 points: Program error, no output, or chart cannot be displayed."
  },
  {
    "metric": "1.3.2 K-means Comprehensive Functionality: Calculate cluster centers, generate Excel file, and visualize scatter plot",
    "description": "1. **Arrange:** Ensure src/mdl4.xlsx file exists and matplotlib displays charts properly.\n2. **Act:** Run the command `python src/聚类算法.py`.\n3. **Assert:** Verify the console outputs 14 cluster center coordinates, generates cluster_points.xlsx file, and displays the complete cluster scatter plot (colored store scatter and red X markers).",
    "expected_output": "2 points: Console outputs 14 cluster center coordinates, Excel file is generated (≥14 sheets), and complete cluster scatter plot is displayed (colored store scatter, 14 red X markers, colorbar, Chinese labels) - all 3 features. 1 point: 2 features completed or number of cluster centers is 10-13. 0 points: Fewer than 2 features or cluster centers <10."
  },
  {
    "metric": "1.3.3 K-means Coordinate Reasonableness: Cluster center coordinates are within Anhui province",
    "description": "1. **Arrange:** Run src/聚类算法.py to get cluster center coordinates.\n2. **Act:** Check all output cluster center coordinates.\n3. **Assert:** Verify all longitudes are in the 115-120 range, and latitudes in the 30-35 range.",
    "expected_output": "2 points: All 14 cluster center coordinates are within Anhui province. 1 point: 12-13 cluster center coordinates are within range. 0 points: Fewer than 12 cluster center coordinates are within range."
  },
  {
    "metric": "1.3.4 Coordinate Standardization: Use StandardScaler for coordinate normalization",
    "description": "1. **Arrange:** Open src/聚类算法.py file.\n2. **Act:** Run the command `python -c \"with open('src/聚类算法.py', 'r', encoding='utf-8') as f: content=f.read(); print('Contains StandardScaler:', 'StandardScaler' in content); print('Contains fit_transform:', 'fit_transform' in content)\"`.\n3. **Assert:** Verify whether StandardScaler is imported and used in the code.",
    "expected_output": "2 points: Code clearly imports and uses StandardScaler for coordinate normalization. 1 point: Code contains StandardScaler but usage is incomplete. 0 points: StandardScaler is not used for normalization in the code."
  },
  {
    "metric": "1.3.5 Excel Worksheet Structure: Contains multiple cluster worksheets",
    "description": "1. **Arrange:** Ensure cluster_points.xlsx file is generated.\n2. **Act:** Run the command `python -c 'import openpyxl; wb=openpyxl.load_workbook(\"cluster_points.xlsx\"); print(\"Number of worksheets:\", len(wb.sheetnames)); print(\"First 5 worksheets:\", wb.sheetnames[:5])'`.\n3. **Assert:** Check whether the output shows at least 14 worksheets and worksheet names contain the word \"Cluster\".",
    "expected_output": "2 points: Excel file contains at least 14 worksheets and worksheet names are in the format \"Cluster X\". 1 point: Contains 10-13 worksheets or worksheet names are basically correct. 0 points: Worksheet count <10 or names are not standardized."
  },
  {
    "metric": "2.1 Weight Normalization: Normalize weight data",
    "description": "1. **Arrange:** Open src/单重心法.py file.\n2. **Act:** Run the command `python -c \"with open('src/单重心法.py', 'r', encoding='utf-8') as f: content=f.read(); print('Contains weight normalization:', 'weights /=' in content or 'weights = weights /' in content or 'np.sum(weights)' in content)\"`.\n3. **Assert:** Verify that weight normalization logic is present in the code.",
    "expected_output": "2 points: Code clearly contains weight normalization logic. 1 point: Contains weight processing but method is not standard. 0 points: No weight normalization performed."
  },
  {
    "metric": "3.1 Output Consistency: Stable results from multiple runs",
    "description": "1. **Arrange:** Ensure src/单重心法.py runs properly.\n2. **Act:** Execute `python src/单重心法.py` twice in succession and record the centroid coordinates for both runs.\n3. **Assert:** Compare whether the centroid longitude and latitude coordinates are exactly the same for both runs (accurate to 6 decimal places).",
    "expected_output": "2 points: Results are identical for both runs, coordinates match exactly to 6 decimal places. 1 point: Results match up to 4-5 decimal places for both runs. 0 points: Results vary significantly or differ within the first 3 decimal places."
  }
]